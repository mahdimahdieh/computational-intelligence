% Exercise Template
%A LaTeX template for typesetting exercise in Persian (with cover page).
%By: Zeinab Seifoori

\documentclass[12pt]{exam}

\usepackage{setspace}
\usepackage{listings}
\usepackage{xcolor}

% Define colors
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}


% Configure listings style
\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\footnotesize\setLTR,
	breakatwhitespace=true,         
	breaklines=true,                 
	captionpos=top, % Changed to top placement
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2,
	frame=single,
	abovecaptionskip=5pt, % Space between caption and code
	belowcaptionskip=5pt, % Space between code and potential bottom text
}


\lstset{style=mystyle}

% Set Persian caption for listings
\renewcommand{\lstlistingname}{برنامه}

\usepackage{graphicx,subfigure,wrapfig}
\usepackage{multirow}
%\usepackage{multicol}


%%%%%%%%%  for pie chart %%%%%
\usepackage{pgf-pie}  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[margin=20mm]{geometry}
\usepackage{hyperref}
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	filecolor=magenta,      
	urlcolor=cyan,
	pdftitle={Overleaf Example},
	pdfpagemode=FullScreen,
}
\usepackage{xepersian}
\settextfont{XB Niloofar}

\newcommand{\class}{درس مبانی هوش محاسباتی}
\newcommand{\term}{نیم‌سال دوم ۰۱-۰۲}
\newcommand{\college}{دانشکده مهندسی کامپیوتر}
\newcommand{\prof}{استاد: دکتر کارشناس}

\onehalfspacing
\parindent 0ex
\begin{document}
	
	\include{info}
	\pagestyle{empty}
	\include{cover-page}
	
	% These commands set up the running header on the top of the exam pages
	\pagestyle{head}
	\firstpageheader{}{}{}
	\runningheader{صفحه \thepage\ از \numpages}{}{\class}
	\runningheadrule
	%\begin{tabular}{p{.7\textwidth} l}
	%\multicolumn{2}{c}{\textbf{به نام خدا}}\\
	%\multirow{2}{*}{\includegraphics[scale=0.2] {images/logo.png}} & \\ \\
	%&  \textbf{\class}\\
	%&  \textbf{\term}\\
	%&  \textbf{\prof}\\ \\
	% \textbf{\college} &  \\
	%\end{tabular}\\
	
	%\rule[1ex]{\textwidth}{.1pt}
	%\textbf{تمرین سری پنجم}
	
	%\rule[1ex]{\textwidth}{.1pt}
	%\makebox[45mm]{\hrulefill}\\
	\tableofcontents
	\vspace{1cm}
	\setcounter{section}{-1}
	\section{مقدمه}
	هدف از این تمرین آشنایی بیشتر با الگوریتم‌های ژنتیک و استفاده‌ی بیشتر از آن‌ها در کاربردهای عملی است.
	\section{
		مبانی و مفاهیم الگوریتم ژنتیک}
	
	
	\section{
		درک و حل مسائل با الگوریتم ژنتیک}
	\begin{questions}
		\question
		\begin{parts}
			\part طول
			$n\times\frac{n - 1}{2} $
			\part
		\end{parts}
		
		\question
		\begin{parts}
			\part ژن‌ها  را به تابع 
			fitness
			می‌بریم:
			\[\mathrm{fit} (x_1) = 6+5-4-1+3+5-3-2=9 \]
			\[\mathrm{fit} (x_2) = 8+7-1-2+6+6-0-1=23\]
			\[\mathrm{fit} (x_3) = 2+3-9-2+1+2-8-5=-16\]
			\[\mathrm{fit} (x_4) = 4+1-8-5+2+0-9-4=-19 \]

			به ترتیب
			$x_2$، $x_1$،$x_3$ و $x_4$
			برازنده هستند.
			
			\part عملیات ترکیب
			\begin{itemize}
				\item
				ترکیب نقطه‌ای: در این روش به دو فرزند جدید می‌رسیم.
				\[x_{21} = 8712|3532\]
				\[x_{21}=6541|6601\]
				\item
				ترکیب دو نقطه‌ای: با استفاده از این روش به دو فرزند جدید می‌رسیم. ما فرض می‌کنیم منظور از نقاط b و f یعنی بعد از این نقاط ترکیب اتفاق می‌افتد
				\[x_{131} = 65|9212|35\]
				\[x_{313}=23|4135|85\]
				\item 
				ترکیب یکنواخت: برای انجام این ترکیب نیازمند به یک ماسک هستیم. این ماسک یک ژن تصادفی با مقادیر دودویی است که نشانگر این است که آن ژن را از کروموزوم اول بگیریم یا دوم. که انتخاب اول یا دوم هم احتمال است. ما با استفاده از
				
				
				\lstinputlisting[language=Python, caption= تولید ماسک تصادفی]{./scripts/mask.py}
				
				
				
				یک رشته‌ی تصادفی از ۰ و ۱ تولید می‌کنیم. ما فرض می‌کنیم ۰  معادل رشته‌ی اول و ۱ معادل رشته‌ی سوم باشد.
				
				\[\mathrm{mask} = 01001010\]
				\[x_{13} = 8|3|12|1|6|8|1\]
				\[x_{31}=2|7|92|6|2|0|5\]
			\end{itemize}
			\part
			برازش فرزندان: با استفاده از تکه کد زیر برازندگی هر فرزند را محاسبه می‌کنیم:
			
			
			\lstinputlisting[language=Python, caption= محاسبه‌ی برازندگی]{./scripts/fitness.py}
			
			\[\mathrm{fit} (x_{21} )= 87123532=15\]
			\[\mathrm{fit} (x_{21})= 65416601=17\]
			\[\mathrm{fit} (x_{131}) = 65921235 = -5\]
			\[\mathrm{fit} (x_{313}) = 23413585 = -5\]
			\[\mathrm{fit} (x_{23}) = 83121681 = 6\]
			\[\mathrm{fit} (x_{32}) = 27926205 =1\]
			تعبیر بهتر شدن و بدتر شدن تعبیر نا دقیقی است. ما دو شاخص را برای بهتر شدن و بدتر شدن در نظر می‌گیریم.
			\begin{enumerate}
				\item بالاترین برازندگی: در والدها بالاترین برازندگی ۲۳ بود که به ۱۷ کاهش یافت یعنی بدتر شده.
				\item میانگین برازندگی: در شرایط قبلی برازندگی معادل
				$\frac{9+23-16-19}{4}=\frac{-3}{4} =-0.75 $
				می‌شود و در فرزندان 
				$\frac{15+17-5-5+6+1}{6}=\frac{29}{6} \approx4.83 $
				می‌شود که رشد قابل توجهی است.
			\end{enumerate}
			\part
			برای بیشینه کردن برازندگی، ژن‌های
			\lr{a}، 
			\lr{b}،
			\lr{e} و
			\lr{f}
			باید مقدار ۹ داشته باشند و 
			\lr{c}، 
			\lr{d}،
			\lr{g} و
			\lr{h}
			باید مقدار ۰ را داشته باشند. برازندگی بهینه برابر 
			$4 \times 9 - 0 = 36$
			می‌شود.
			\part
			ما سعی کردیم بهترین ترکیب را بسیازیم  و آن
			$x_{\mathrm{optimal}}= 87116601$
			خواهد بود که برازندگی آن ۲۴ خواهد شد. پس نمی‌توان بدون جهش به نقطه‌ی بهینه رسید و حداقل ۱۲ تا فاصله با نقطه‌ی برازندگی وجود خواهد داشت.
		\end{parts} 
		\question
		\begin{parts}
			\part\label{p2-3-a}
			مقدار برازندگی به ازای هر 
			\lr{x}:
			\[\mathrm{fit} (x_{1}) = 1-4+7=4\]
			\[\mathrm{fit} (x_{2}) = 8-16+7=-1\]
			\[\mathrm{fit} (x_{3}) = 27-36+7=-2\]
			\[\mathrm{fit} (x_{4}) = 64-64+7=7\]
			\part
			بله. می‌توانیم با اضافه کردن 
			$\forall c : c \ge 2$
			همه‌ی مقدارها را نامنفی کنیم.
			مثلا اگر 
			$c=3$ 
			در نظر بگیریم رابطه‌ی برازندگی 
			$\mathrm{fit} (x) = x^3 - 4 x^2 + 10$
			خواهد شد.
			
			\part به هر برازندگی مقدار ثابت ۲ اضافه می‌شود پس 
			\[\mathrm{Total Fitness} = (4+3)\times 2+(-1+3)\times 3+(-2+3)\times3+(7+3)\times2\]
			\[=14+6+3+20=43\]
			\part 
			مقدار برازندگی نسبی برای هر نمونه‌ی  x به صورت زیر خواهد شد:
			
			\[ P(x=1) = \frac{7}{43} = 0.1628 \]  
			\[P(x=2)=\frac{2}{43}=0.0465\]
			\[P(x=3)=\frac{1}{43}=0.0233\]
			\[P(x=4)=\frac{10}{43}=0.2326\]
			می‌توانیم آن را به صورت یک گردونه هم نشان دهیم.
			
			\begin{wrapfigure}[l]{l}{.4\textwidth}
				\begin{center}
\begin{tikzpicture}[x=0.05\textwidth, y=0.05\textwidth]
\pie{
	16/\rl{نفر اول}  ,
	16/دوم,
	5/سوم,
	5/چهارم,
	5/ پنجم,
	3/ششم,
	2/ هفتم,
	2/هشتم,
	23/نهم,
	23/ دهم}
	\end{tikzpicture}
	\caption{گردونه‌ی شانس برای این نمونه از جمعیت}
	\end{center}
\end{wrapfigure}
			

			
			\part 
			مزیت تابع جدید این است که به ازا‌ی هر مقدار 
			\lr{x}،
			تابع برازندگی همواره نامنفی است. برای محاسبه‌ی 
			$g(x)$
			تمام مقدادیر بدست آمده در بخش
			\ref{p2-3-a}
			را به توان ۲ می‌رسانیم.
			\[\mathrm{fit} (x_{1}) =4^2=16\]
			\[\mathrm{fit} (x_{2}) =(-1)^2=1\]
			\[\mathrm{fit} (x_{3}) =(-2)^2=4\]
			\[\mathrm{fit} (x_{4}) =7^2=49\]
			\part تاثیر بر فشار انتخاب را توضیح بده!!!!!!
			
			همچنین تاثیر آن در تنوع و همگرایی را بگو
		\end{parts}
		
	\end{questions}
	
	\section[
	پیاده‌سازی، ارزیابی و تجزیه‌ و تحلیل الگوریتم ژنتیک]{پیاده‌سازی، ارزیابی و تجزیه‌ و تحلیل الگوریتم ژنتیک جهت انتخاب بهترین ویژگی برای مسئله‌ی واقعی دسته‌بندی مشتریان} 
\end{document}